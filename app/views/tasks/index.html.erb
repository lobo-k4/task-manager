<div class="card-body">
  <h6>Estado</h6>
  <%= link_to 'Todas', tasks_path, class: 'btn btn-outline-primary btn-sm mb-2' %>
  <%= link_to 'Pendientes', tasks_path(status: 'pending'), class: 'btn btn-outline-warning btn-sm mb-2' %>
  <%= link_to 'Completadas', tasks_path(status: 'completed'), class: 'btn btn-outline-success btn-sm mb-2' %>
  
  <!-- SECCIÓN CORREGIDA: -->
  <% if current_user.respond_to?(:categories) && current_user.categories.any? %>
    <h6 class="mt-3">Categorías</h6>
    <%= link_to 'Todas', tasks_path, class: 'btn btn-outline-secondary btn-sm mb-2' %>
    <% current_user.categories.each do |category| %>
      <%= link_to category.name, tasks_path(category_id: category.id), 
            class: "btn btn-sm mb-2",
            style: "background-color: #{category.color}; color: white; border: none;" %>
    <% end %>
  <% end %>
  
  <% if params[:status].present? || params[:category_id].present? || params[:search].present? %>
    <div class="mt-3">
      <%= link_to 'Limpiar todos los filtros', tasks_path, class: 'btn btn-outline-danger btn-sm' %>
    </div>
  <% end %>
</div>

